# Internationalization (i18n)

Tracktor uses Paraglide (inlang) with the Svelte 5 addon for runtime-localized UI and proper `lang` propagation.

## How it works

- Paraglide runtime and middleware are scaffolded under `src/lib/paraglide/`.
- `src/hooks.server.ts` uses `paraglideMiddleware` to determine the request locale and set the HTML `lang` attribute (see `src/app.html`).
- The current locale is determined via Paraglide's strategy (cookie → global variable → base locale) and can be updated at runtime.
- App configuration stores the preferred locale in the `configs` table (`key = 'locale'`).

## Config-driven locale

- On startup and whenever configs refresh, the app sets Paraglide's locale without reloading for a smooth init (`setLocale(configs.locale, { reload: false })`).
- When you change locale from Settings, the app saves the new value and then calls `setLocale(newLocale)` which updates the cookie and reloads the page.

## Changing the language

1. Go to Dashboard → Settings.
2. Under Personalization, use the Locale dropdown to choose a language.
3. The app reloads with the new locale and remembers it via cookie and configs.

## Adding a new language

1. Add the language in your Paraglide source/messages and regenerate the compiled outputs under `src/lib/paraglide/messages/`.
2. Ensure the new language code is included in Paraglide's generated `locales` array (in `src/lib/paraglide/runtime.js`).
3. Optionally add a human-readable label in `src/lib/components/feature/settings/SettingsForm.svelte` in the `localeLabels` map.
4. Provide translations for your messages via inlang tooling (VS Code Sherlock, Fink, etc.).

## Notes

- The `lang` attribute is set server-side for accessibility and SEO.
- If you integrate URL-based localization later, update Paraglide `strategy` to include `url` and keep the existing middleware as-is.
